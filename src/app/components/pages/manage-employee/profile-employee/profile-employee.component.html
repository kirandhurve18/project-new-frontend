<!-- Updated Employee Registration Form -->
<div class="container-fluid">
  <!-- Header -->
  <div class="container-fluid my-3">
    <div
      class="bg-white rounded shadow-sm px-3 py-3 d-flex justify-content-between align-items-center flex-wrap"
    >
      <h5 class="fw-bold mb-0">Employee Info</h5>
      <button
        *ngIf="!isUpdateMode"
        type="button"
        (click)="onUpdate()"
        style="background-color: #00ce00; color: white"
        class="btn btn-block px-4"
      >
        Update Form
      </button>
    </div>
  </div>

  <!-- Main Form Card -->
  <div class="d-flex justify-content-center align-items-center">
    <div
      class="card shadow rounded p-4 w-100"
      style="max-width: 1617px; background-color: #ffffff"
    >
      <div class="card-body">
        <form #regForm="ngForm">
          <div class="row g-4">
            <!-- Left Column -->
            <div class="col-md-6">
              <!-- Employee Info -->
              <div class="mb-2 row align-items-center">
                <label class="col-sm-4 col-form-label fw-semibold"
                  >Employee ID<span class="text-danger">*</span> :</label
                >
                <div class="col-sm-8">
                  <input
                    [readOnly]="isUpdateMode"
                    type="text"
                    class="form-control form-control-sm"
                    [(ngModel)]="formData.employee_id"
                    name="employee_id"
                    placeholder="Enter Employee ID"
                  />
                </div>
              </div>

              <div class="mb-2 row align-items-center">
                <label class="col-sm-4 col-form-label fw-semibold"
                  >First Name<span class="text-danger">*</span> :</label
                >
                <div class="col-sm-8">
                  <input
                    [readOnly]="isUpdateMode"
                    type="text"
                    class="form-control form-control-sm"
                    [(ngModel)]="formData.first_name"
                    name="first_name"
                    placeholder="Enter First Name"
                  />
                </div>
              </div>

              <div class="mb-2 row align-items-center">
                <label class="col-sm-4 col-form-label fw-semibold"
                  >Middle Name:</label
                >
                <div class="col-sm-8">
                  <input
                    [readOnly]="isUpdateMode"
                    type="text"
                    class="form-control form-control-sm"
                    [(ngModel)]="formData.middle_name"
                    name="middle_name"
                    placeholder="Enter Middle Name"
                  />
                </div>
              </div>

              <div class="mb-2 row align-items-center">
                <label class="col-sm-4 col-form-label fw-semibold"
                  >Last Name<span class="text-danger">*</span> :</label
                >
                <div class="col-sm-8">
                  <input
                    [readOnly]="isUpdateMode"
                    type="text"
                    class="form-control form-control-sm"
                    [(ngModel)]="formData.last_name"
                    name="last_name"
                    placeholder="Enter Last Name"
                  />
                </div>
              </div>
              <div class="mb-2 row align-items-center">
                <label class="col-sm-4 col-form-label fw-semibold"
                  >Company Email<span class="text-danger">*</span> :</label
                >
                <div class="col-sm-8">
                  <input
                    [readOnly]="isUpdateMode"
                    type="text"
                    class="form-control form-control-sm"
                    [(ngModel)]="formData.company_email"
                    name="company_email"
                    placeholder="Enter Company Email"
                  />
                </div>
              </div>
              <div class="mb-2 row align-items-center">
                <label class="col-sm-4 col-form-label fw-semibold">
                  Password<span class="text-danger">*</span> :
                </label>

                <div class="col-sm-8 position-relative">
                  <input
                    [readOnly]="isUpdateMode"
                    [type]="showPassword ? 'text' : 'password'"
                    class="form-control form-control-sm"
                    [(ngModel)]="formData.password"
                    name="password"
                    placeholder="Enter Password"
                  />
                  <!-- (click)="togglePassword()" -->
                  <i
                    class="bi"
                    [ngClass]="showPassword ? 'bi-eye-slash' : 'bi-eye'"
                    style="
                      cursor: pointer;
                      position: absolute;
                      top: 50%;
                      right: 20px;
                      transform: translateY(-50%);
                    "
                  ></i>
                </div>
              </div>

              <div class="mb-2 row align-items-center">
                <label class="col-sm-4 col-form-label fw-semibold"
                  >Personal Email:</label
                >
                <div class="col-sm-8">
                  <input
                    [readOnly]="isUpdateMode"
                    type="text"
                    class="form-control form-control-sm"
                    [(ngModel)]="formData.personal_email"
                    name="personal_email"
                    placeholder="Enter Personal Email"
                  />
                </div>
              </div>

              <!-- Add other fields similarly -->

              <!-- Current & Permanent Address -->
              <div class="mb-2 row align-items-center">
                <label class="col-sm-4 col-form-label fw-semibold"
                  >Current Address <span class="text-danger">*</span>:</label
                >
                <div class="col-sm-8">
                  <input
                    [readOnly]="isUpdateMode"
                    type="text"
                    class="form-control form-control-sm"
                    [(ngModel)]="formData.current_address"
                    name="current_address"
                    placeholder="Enter Current Address"
                    (ngModelChange)="syncAddress()"
                  />
                </div>
              </div>

              <!-- Address Same Checkbox -->
              <div class="mb-2">
                <div class="form-check ps-4">
                  <!-- [(ngModel)]="formData.is_current_add_same_as_permanent" -->
                  <input
                    [readOnly]="isUpdateMode"
                    class="form-check-input"
                    type="checkbox"
                    name="same_address"
                    (change)="syncAddress()"
                  />
                  <label class="form-check-label">
                    Is Current Address same as Permanent Address?
                  </label>
                </div>
              </div>

              <div class="mb-2 row align-items-center">
                <label class="col-sm-4 col-form-label fw-semibold"
                  >Permanent Address:</label
                >
                <div class="col-sm-8">
                  <!-- [readonly]="formData.is_current_add_same_as_permanent" -->
                  <input
                    [readOnly]="isUpdateMode"
                    type="text"
                    class="form-control form-control-sm"
                    [(ngModel)]="formData.permanent_address"
                    name="permanent_address"
                    placeholder="Enter Permanent Address"
                  />
                </div>
              </div>

              <div class="mb-2 row align-items-center">
                <label class="col-sm-4 col-form-label fw-semibold"
                  >Date of Birth:</label
                >
                <div class="col-sm-8">
                  <input
                    [readOnly]="isUpdateMode"
                    type="date"
                    class="form-control form-control-sm"
                    [(ngModel)]="formData.date_of_birth"
                    name="date_of_birth"
                    placeholder="Select Employee DOB"
                  />
                </div>
              </div>

              <div class="mb-2 row align-items-center">
                <label class="col-sm-4 col-form-label fw-semibold"
                  >Date of Joining<span class="text-danger">*</span> :</label
                >
                <div class="col-sm-8">
                  <input
                    [readOnly]="isUpdateMode"
                    type="date"
                    class="form-control form-control-sm"
                    [(ngModel)]="formData.date_of_joining"
                    name="date_of_joining"
                    placeholder="Select Employee Joining Date"
                  />
                </div>
              </div>

              <div class="mb-2 row align-items-center">
                <label class="col-sm-4 col-form-label fw-semibold">
                  Probation Period Ends On <span class="text-danger">*</span> :
                </label>
                <div class="col-sm-8">
                  <input
                    [readOnly]="isUpdateMode"
                    type="date"
                    class="form-control form-control-sm"
                    name="probation_period_ends_on"
                    [(ngModel)]="formData.probation_period_ends_on"
                    required
                  />
                </div>
              </div>

              <div class="mb-2 row align-items-center">
                <label class="col-sm-4 col-form-label fw-semibold"
                  >Last Working Day :</label
                >
                <div class="col-sm-8">
                  <input
                    [readOnly]="isUpdateMode"
                    type="date"
                    class="form-control form-control-sm"
                    name="last_working_day"
                    placeholder="Enter Employee Last Working day "
                  />
                </div>
              </div>

              <!-- Notice Period -->
              <div class="mb-2 row align-items-center">
                <label class="col-sm-4 col-form-label fw-semibold"
                  >Notice Period:</label
                >
                <div class="col-sm-8">
                  <input
                    [readOnly]="isUpdateMode"
                    type="number"
                    class="form-control form-control-sm"
                    [(ngModel)]="formData.notice_period"
                    name="notice_period"
                    placeholder="Enter notice period in days"
                  />
                </div>
              </div>

              <!-- Work Experience -->
              <div class="mb-2 row align-items-center">
                <label class="col-sm-4 col-form-label fw-semibold"
                  >Work Experience:</label
                >
                <div class="col-sm-8">
                  <input
                    [readOnly]="isUpdateMode"
                    type="number"
                    class="form-control form-control-sm"
                    [(ngModel)]="formData.work_experience"
                    name="work_experience"
                    placeholder="Enter Employee Work Experience "
                  />
                </div>
              </div>

              <!-- Qualification Table -->
              <div class="mb-3">
                <label class="form-label fw-semibold"
                  >Qualification Details</label
                >
                <div class="table-responsive">
                  <table
                    class="table table-bordered table-sm align-middle mb-0"
                  >
                    <thead>
                      <tr>
                        <th style="background-color: #009688; color: white">
                          Subject
                        </th>
                        <th style="background-color: #009688; color: white">
                          Year of Passing
                        </th>
                        <th style="background-color: #009688; color: white">
                          Percentage
                        </th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr
                        *ngFor="
                          let item of [
                            'tenth',
                            'twelfth',
                            'graduation',
                            'post graduation'
                          ];
                          let i = index
                        "
                      >
                        <td>
                          {{
                            item == "post graduation"
                              ? "Post Graduation"
                              : item == "graduation"
                              ? "Graduation"
                              : item == "twelfth"
                              ? "Twelfth"
                              : item == "tenth"
                              ? "Tenth"
                              : item
                          }}
                        </td>
                        <td>
                          <input
                            [readOnly]="isUpdateMode"
                            type="number"
                            class="form-control form-control-sm"
                            name="year_{{ i }}"
                            [(ngModel)]="qualificationMap[item].year"
                          />
                        </td>
                        <td>
                          <input
                            [readOnly]="isUpdateMode"
                            type="number"
                            class="form-control form-control-sm"
                            name="percentage_{{ i }}"
                            [(ngModel)]="qualificationMap[item].percentage"
                          />
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>

            <!-- Right Column -->
            <div class="col-md-6">
              <div class="mb-2 row align-items-center">
                <label class="col-sm-4 col-form-label fw-semibold"
                  >Salary:</label
                >
                <div class="col-sm-8">
                  <input
                    [readOnly]="isUpdateMode"
                    type="number"
                    class="form-control form-control-sm"
                    [(ngModel)]="formData.salary"
                    name="salary"
                    placeholder="Enter Employee Yearly Salary "
                  />
                </div>
              </div>

              <!-- Employment Type -->
              <div class="mb-2 row align-items-center">
                <label class="col-sm-4 col-form-label fw-semibold"
                  >Employment Type:</label
                >
                <div class="col-sm-8">
                  <select
                    [disabled]="isUpdateMode"
                    class="form-select form-select-sm"
                    [(ngModel)]="formData.employment_type"
                    name="employment_type"
                    required
                  >
                    <option value="" disabled hidden>
                      Select Employment Type
                    </option>
                    <option *ngFor="let type of employment_type" [value]="type">
                      {{ type }}
                    </option>
                  </select>
                </div>
              </div>
              <!-- Department -->
              <div class="mb-2 row align-items-center">
                <label class="col-sm-4 col-form-label fw-semibold"
                  >Department:</label
                >
                <div class="col-sm-8">
                  <select
                    [disabled]="isUpdateMode"
                    class="form-select form-select-sm"
                    [(ngModel)]="formData.department_id"
                    name="department"
                    required
                  >
                    <option value="">Select Department</option>
                    <option *ngFor="let dept of departments" [value]="dept._id">
                      {{ dept.department_name }}
                    </option>
                  </select>
                </div>
              </div>

              <!-- Designation -->
              <!-- Designation -->
              <div class="mb-2 row align-items-center">
                <label class="col-sm-4 col-form-label fw-semibold"
                  >Designation:</label
                >
                <div class="col-sm-8">
                  <select
                    [disabled]="isUpdateMode"
                    class="form-select form-select-sm"
                    [(ngModel)]="formData.designation_id"
                    name="designation"
                    required
                  >
                    <option value="">Select Designation</option>
                    <option
                      *ngFor="let desig of designations"
                      [value]="desig._id"
                    >
                      {{ desig.designation_name }}
                    </option>
                  </select>
                </div>
              </div>

              <!-- Sub-Designation -->
              <!-- <div class="mb-2 row align-items-center">
                <label class="col-sm-4 col-form-label fw-semibold"
                  >Sub-Designation:</label
                >
                <div class="col-sm-8">
                  <select
                    class="form-select form-select-sm"
                    [(ngModel)]="formData.sub_designation_id"
                    name="sub_designation"
                    required
                  >
                    <option value="">Select Sub-Designation</option>
                    <option
                      *ngFor="let sub of sub_designations"
                      [value]="sub._id"
                    >
                      {{ sub.sub_designation_name }}
                    </option>
                  </select>
                </div>
              </div> -->

              <!-- Team Lead -->
              <div class="mb-2 row align-items-center">
                <label class="col-sm-4 col-form-label fw-semibold"
                  >Team Lead<span class="text-danger">*</span> :</label
                >
                <div class="col-sm-8">
                  <select
                    [disabled]="isUpdateMode"
                    class="form-control"
                    [(ngModel)]="formData.team_lead_id"
                    name="team_lead_id"
                  >
                    <option value="">Select Team Lead</option>
                    <option *ngFor="let lead of teamLeads" [value]="lead._id">
                      {{ lead.first_name }} {{ lead.last_name }}
                    </option>
                  </select>
                </div>
              </div>

              <!-- Team Manager-->
              <div class="mb-2 row align-items-center">
                <label class="col-sm-4 col-form-label fw-semibold"
                  >Team Manager:</label
                >
                <div class="col-sm-8">
                  <select
                    [disabled]="isUpdateMode"
                    class="form-select form-select-sm"
                    [(ngModel)]="formData.team_manager_id"
                    name="team_manager_id"
                  >
                    <option value="">Select Team Manager</option>
                    <option
                      *ngFor="let manager of teamManagers"
                      [value]="manager._id"
                    >
                      {{ manager.first_name }} {{ manager.last_name }}
                    </option>
                  </select>
                </div>
              </div>

              <!-- Role -->
              <div class="mb-2 row align-items-center">
                <label
                  for="teamSelect"
                  class="col-sm-4 col-form-label fw-semibold"
                  >Role:</label
                >

                <div class="col-sm-5">
                  <select
                    [disabled]="isUpdateMode"
                    id="teamSelect"
                    class="form-select form-select-sm"
                    [(ngModel)]="formData.role"
                    name="role"
                    required
                  >
                    <option value="" disabled hidden>Select Role</option>
                    <option value="lead">Team Lead</option>
                    <option value="manager">Manager</option>
                    <option value="employee">Employee</option>
                    <option value="admin" hidden>Admin</option>
                  </select>
                </div>
              </div>

              <!-- Role Permissions -->
              <div class="mb-2 row align-items-center">
                <label
                  for="roleSelect"
                  class="col-sm-4 col-form-label fw-semibold"
                  >Permissions<span class="text-danger">*</span> :</label
                >

                <div class="col-sm-5">
                  <select
                    [disabled]="isUpdateMode"
                    id="roleSelect"
                    class="form-select form-select-sm"
                    [(ngModel)]="formData.role_id"
                    name="role_id"
                    required
                  >
                    <option value="" disabled hidden>Select Role</option>
                    <option *ngFor="let role of roles" [value]="role._id">
                      {{ role.role_name }}
                    </option>
                  </select>
                </div>

                <div
                  class="col-sm-3 text-start text-md-end"
                  *ngIf="!isUpdateMode"
                >
                  <button
                    *ngIf="formData.role_id"
                    type="button"
                    class="btn btn-link btn-sm mt-2 mt-md-0 p-0 underline-text"
                    data-bs-toggle="modal"
                    data-bs-target="#addRoleModal"
                    (click)="openEditRoleModal()"
                  >
                    View Permissions
                  </button>
                </div>
              </div>

              <div
                class="modal fade"
                id="addRoleModal"
                tabindex="-1"
                aria-labelledby="addRoleModalLabel"
                aria-hidden="true"
              >
                <div class="modal-dialog modal-lg modal-dialog-centered">
                  <div class="modal-content custom-modal-content">
                    <!-- Modal Header -->
                    <div
                      class="modal-header px-4 py-3 d-flex justify-content-between align-items-center"
                      style="background-color: #009688; color: #ffffff"
                    >
                      <h5
                        class="modal-title fw-bold mb-0"
                        id="addRoleModalLabel"
                      >
                        {{ modalTitle }}
                      </h5>
                      <img
                        src="{{ cross_close_icon }}"
                        alt="Close"
                        (click)="closeAddTaskPopup()"
                        data-bs-dismiss="modal"
                        style="cursor: pointer; width: 16px; height: 16px"
                      />
                    </div>

                    <!-- Modal Body -->
                    <div class="modal-body px-4 py-3">
                      <form>
                        <div class="row g-3 mb-4">
                          <div class="col-md-6">
                            <label for="roleName" class="form-label fw-semibold"
                              >Role Name</label
                            >
                            <input
                              type="text"
                              id="roleName"
                              class="form-control"
                              disabled
                              placeholder="Enter Role Name"
                              [(ngModel)]="currentRole.role_name"
                              name="roleName"
                            />
                          </div>
                          <div class="col-md-6">
                            <label
                              for="roleStatus"
                              class="form-label fw-semibold"
                              >Role Status</label
                            >
                            <input
                              type="text"
                              id="roleStatus"
                              class="form-control"
                              disabled
                              placeholder=""
                              [(ngModel)]="currentRole.status"
                              name="roleStatus"
                            />
                          </div>
                        </div>

                        <hr />

                        <h6 class="fw-bold">Role Permissions</h6>
                        <div
                          class="d-flex flex-wrap align-items-center mb-3 gap-4"
                        >
                          <div class="form-check">
                            <input
                              class="form-check-input"
                              type="checkbox"
                              id="adminAccess"
                            />
                            <label
                              class="form-check-label fw-semibold"
                              for="adminAccess"
                              >Administrator Access</label
                            >
                          </div>
                          <div class="form-check">
                            <input
                              class="form-check-input"
                              type="checkbox"
                              id="selectAll"
                              disabled
                            />
                            <label
                              class="form-check-label fw-semibold"
                              for="selectAll"
                              >Select All</label
                            >
                          </div>
                        </div>

                        <!-- Permission List -->
                        <div class="table-responsive">
                          <table
                            class="table table-borderless align-middle mb-0"
                          >
                            <tbody>
                              <tr *ngFor="let module of permissions">
                                <td
                                  class="fw-semibold"
                                  style="min-width: 180px"
                                >
                                  {{ module.name }}
                                </td>
                                <td>
                                  <div class="form-check">
                                    <input
                                      disabled
                                      type="checkbox"
                                      class="form-check-input"
                                      [(ngModel)]="module.read"
                                      [name]="'read_' + module.name"
                                    />
                                    <label class="form-check-label">Read</label>
                                  </div>
                                </td>
                                <td>
                                  <div class="form-check">
                                    <input
                                      disabled
                                      type="checkbox"
                                      class="form-check-input"
                                      [(ngModel)]="module.write"
                                      [name]="'write_' + module.name"
                                    />
                                    <label class="form-check-label"
                                      >Write</label
                                    >
                                  </div>
                                </td>
                                <td>
                                  <div class="form-check">
                                    <input
                                      disabled
                                      type="checkbox"
                                      class="form-check-input"
                                      [(ngModel)]="module.create"
                                      [name]="'create_' + module.name"
                                    />
                                    <label class="form-check-label"
                                      >Create</label
                                    >
                                  </div>
                                </td>
                              </tr>
                            </tbody>
                          </table>
                        </div>
                      </form>
                    </div>

                    <!-- Modal Footer -->
                    <div class="modal-footer px-4 py-3">
                      <button
                        type="button"
                        class="btn btn-outline-danger"
                        data-bs-dismiss="modal"
                      >
                        Close
                      </button>
                      <!-- <button type="submit" class="btn btn-success">
                        Submit
                      </button> -->
                    </div>
                  </div>
                </div>
              </div>

              <div class="mb-2 row align-items-center">
                <label class="col-sm-4 col-form-label fw-semibold"
                  >Employee Number<span class="text-danger">*</span> :</label
                >
                <div class="col-sm-4">
                  <input
                    [readonly]="isUpdateMode"
                    type="number"
                    class="form-control form-control-sm"
                    [(ngModel)]="formData.employee_number"
                    name="employee_number"
                    placeholder="Enter Number"
                  />
                </div>
                <div class="col-sm-4">
                  <input
                    [readOnly]="isUpdateMode"
                    type="number"
                    class="form-control form-control-sm"
                    [(ngModel)]="formData.alternate_number"
                    name="alternate_number"
                    placeholder="Enter Alternate Number"
                  />
                </div>
              </div>

              <div class="mb-2 row align-items-center">
                <label class="col-sm-4 col-form-label fw-semibold"
                  >Emergency contact:</label
                >
                <div class="col-sm-4">
                  <input
                    [readOnly]="isUpdateMode"
                    type="number"
                    class="form-control form-control-sm"
                    [(ngModel)]="formData.emergency_number"
                    name="emergency_number"
                    placeholder="Enter Emergency Number"
                  />
                </div>
                <div class="col-sm-4">
                  <input
                    [readOnly]="isUpdateMode"
                    type="text"
                    class="form-control form-control-sm"
                    [(ngModel)]="formData.family_member_relation"
                    name="family_member_relation"
                    placeholder="Family Member Relation"
                  />
                </div>
              </div>

              <!-- Gender -->
              <div class="mb-2 row align-items-center">
                <label class="col-sm-4 col-form-label fw-semibold"
                  >Gender:</label
                >
                <div class="col-sm-8 d-flex align-items-center gap-3">
                  <div class="form-check">
                    <input
                      [disabled]="isUpdateMode"
                      class="form-check-input"
                      type="radio"
                      name="gender"
                      value="Male"
                      [(ngModel)]="formData.gender"
                    />
                    <label class="form-check-label">Male</label>
                  </div>
                  <div class="form-check">
                    <input
                      [disabled]="isUpdateMode"
                      class="form-check-input"
                      type="radio"
                      name="gender"
                      value="Female"
                      [(ngModel)]="formData.gender"
                    />
                    <label class="form-check-label">Female</label>
                  </div>
                </div>
              </div>

              <!-- Blood Group -->
              <div class="mb-2 row align-items-center">
                <label class="col-sm-4 col-form-label fw-semibold"
                  >Blood Group<span class="text-danger">*</span> :</label
                >
                <div class="col-sm-8">
                  <select
                    [disabled]="isUpdateMode"
                    class="form-select form-select-sm"
                    [(ngModel)]="formData.blood_group"
                    name="blood_group"
                  >
                    <option disabled selected>Select Blood Group</option>
                    <option *ngFor="let group of bloodGroups" [value]="group">
                      {{ group }}
                    </option>
                  </select>
                </div>
              </div>

              <!-- Work Mode -->
              <div class="mb-3 row align-items-center">
                <label class="col-sm-4 col-form-label fw-semibold"
                  >Work Mode:</label
                >
                <div class="col-sm-8 d-flex align-items-center gap-3">
                  <div class="form-check">
                    <input
                      [disabled]="isUpdateMode"
                      class="form-check-input"
                      type="radio"
                      name="work_mode"
                      value="WFO"
                      [(ngModel)]="formData.work_mode"
                    />
                    <label class="form-check-label">Office</label>
                  </div>
                  <div class="form-check">
                    <input
                      [disabled]="isUpdateMode"
                      class="form-check-input"
                      type="radio"
                      name="work_mode"
                      value="HYBRID"
                      [(ngModel)]="formData.work_mode"
                    />
                    <label class="form-check-label">Hybrid</label>
                  </div>
                  <div class="form-check">
                    <input
                      [disabled]="isUpdateMode"
                      class="form-check-input"
                      type="radio"
                      name="work_mode"
                      value="WFH"
                      [(ngModel)]="formData.work_mode"
                    />
                    <label class="form-check-label">Home</label>
                  </div>
                </div>
              </div>

              <!-- Document Uploads -->
              <div class="documents-section mb-3">
                <label class="form-label fw-semibold">Documents:</label>
                <div class="table-responsive">
                  <table class="table table-bordered table-sm align-middle">
                    <thead>
                      <tr class="bg-teal-600 text-white">
                        <th class="px-3 py-2 text-left">Sr. No.</th>
                        <th class="px-3 py-2 text-left">Document Name</th>
                        <th class="px-3 py-2 text-left">Document Upload</th>
                      </tr>
                    </thead>

                    <tbody>
                      <tr
                        *ngFor="let doc of docs; let i = index"
                        class="odd:bg-gray-50 even:bg-white"
                      >
                        <!-- Sr No -->
                        <td class="px-3 py-2">{{ i + 1 }}</td>

                        <!-- Document Name -->
                        <td class="px-3 py-2">{{ doc.name }}</td>

                        <!-- Upload Field / Uploaded File -->
                        <td class="px-3 py-2">
                          <div class="flex items-center gap-2 flex-wrap">
                            <!-- âœ… Already uploaded files -->
                            <ng-container
                              *ngIf="
                                (doc.files?.length ?? 0) > 0;
                                else uploadInput
                              "
                            >
                              <ng-container *ngFor="let f of doc.files">
                                <span
                                  class="flex items-center bg-gray-100 border rounded px-2 py-1 text-sm"
                                >
                                  <a
                                    [href]="getFileUrl(f.path || '')"
                                    target="_blank"
                                    class="text-blue-600 hover:underline"
                                  >
                                    <ng-container *ngFor="let f of doc.files">
                                      <a
                                        *ngIf="f.path; else noPath"
                                        [href]="getFileUrl(f.path)"
                                        target="_blank"
                                        class="text-blue-600 hover:underline"
                                      >
                                        {{ f.path | slice : -35 }}
                                      </a>
                                      <ng-template #noPath>
                                        <span class="text-gray-700">
                                          {{ f.name || "No file available" }}
                                        </span>
                                      </ng-template>
                                    </ng-container>
                                  </a>
                                </span>
                              </ng-container>
                            </ng-container>

                            <!-- Upload input if no files -->
                            <ng-template #uploadInput>
                              <span class="text-gray-700">
                                No file available
                              </span>
                            </ng-template>
                          </div>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>

</div>
