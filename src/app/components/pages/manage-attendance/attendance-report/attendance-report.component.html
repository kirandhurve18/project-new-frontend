<div class="container-fluid">
  <!-- Header -->
  <div
    class="d-flex rounded flex-wrap justify-content-between align-items-center bg-white p-3 box-shadow mb-3"
  >
    <div class="d-flex align-items-center mb-2 mb-md-0">
      <h5 class="fw-bold">Attendance Report</h5>
    </div>
    <div class="d-flex align-items-center flex-wrap" style="gap: 24px">
      <button class="btn btn-teal" (click)="showDailyAttendance()">
        Daily Attendance
      </button>
      <button
        class="btn btn-white"
        (click)="navigateToEmployeeAttendanceReport()"
      >
        Employee Attendance Report
      </button>
    </div>
  </div>

  <!-- Present Employee List -->
  <div class="d-flex flex-column rounded bg-white p-3 box-shadow">
    <div class="d-flex justify-content-between align-items-center flex-wrap">
      <div class="d-flex align-items-center mb-2 mb-md-0">
        <h5 class="fw-bold">Present Employee List</h5>
      </div>
      <div class="d-flex align-items-center gap-3 flex-wrap">
        <input
          type="date"
          [(ngModel)]="fromDate"
          class="form-control"
          style="width: 150px"
        />
        <button class="btn btn-teal px-4" (click)="onDateFilter()">
          Get Attendance
        </button>
      </div>
    </div>

    <div
      style="width: 100%; height: 2px; background-color: #009688; margin: 1rem 0"
    ></div>

    <!-- Show entries + search -->
    <div
      class="d-flex justify-content-between align-items-center flex-wrap mb-3"
    >
      <div class="d-flex align-items-center mb-2 mb-md-0">
        <label class="me-2 mb-0">Show</label>
        <select
          [(ngModel)]="entriesToShow"
          (change)="onEntriesChange()"
          class="form-select form-select-sm"
          style="width: 70px"
        >
          <option [value]="5">5</option>
          <option [value]="10">10</option>
          <option [value]="15">15</option>
          <option [value]="20">20</option>
        </select>
        <span class="ms-2">entries</span>
      </div>

      <div class="input-group" style="max-width: 300px">
        <input
          type="text"
          [(ngModel)]="searchTerm"
          (input)="onSearch()"
          class="form-control"
          placeholder="Search Employee"
        />
        <span class="input-group-text bg-white">
          <img src="{{search_icon}}" alt="Search" width="16" />
        </span>
      </div>
    </div>

    <!-- Attendance Table -->
    <div class="table-responsive">
      <table class="table">
        <thead class="table-header">
          <tr>
            <th>S.No</th>
            <th>Name</th>
            <th>Check In Date</th>
            <th>Check In Time</th>
            <th>Check In Location</th>
            <th>Check Out Date</th>
            <th>Check Out Time</th>
            <th>Check Out Location</th>
            <th>Lat/Long</th>
            <th>Current Status</th>
            <th>Option</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let item of attendanceReportData; let i = index">
            <td>{{ i + 1 }}</td>
            <td>{{ item.name }}</td>
            <td>{{ item.checkInDate }}</td>
            <td>{{ item.checkInTime }}</td>
            <td>{{ item.checkInLocation }}</td>
            <td>{{ item.checkOutDate }}</td>
            <td>{{ item.checkOutTime }}</td>
            <td>{{ item.checkOutLocation }}</td>
            <td>{{ item.latLong }}</td>
            <td>{{ item.currentStatus }}</td>
            <td>
              <!-- Change Status Dropdown -->
              <div class="dropdown" [class.show]="activeRow === i">
                <button
                  class="btn btn-sm btn-outline-primary dropdown-toggle"
                  type="button"
                  (click)="toggleDropdown(i)"
                >
                  Change Status
                </button>
                <ul
                  class="dropdown-menu p-2"
                  [class.show]="activeRow === i"
                  style="min-width: 220px"
                >
                  <li *ngFor="let status of statusOptions">
                    <div class="form-check">
                      <input
                        class="form-check-input"
                        type="radio"
                        name="status-{{ i }}"
                        [checked]="item.currentStatus === status"
                        (change)="updateStatus(item, status)"
                      />
                      <label class="form-check-label">{{ status }}</label>
                    </div>
                  </li>
                </ul>
              </div>
            </td>
          </tr>
          <tr *ngIf="attendanceReportData.length === 0">
            <td colspan="11" class="text-center">No records found</td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Pagination -->
    <div
      class="d-flex flex-wrap justify-content-between align-items-center mt-3"
    >
      <div>
        Showing
        {{ (currentPage - 1) * pageSize + 1 }}
        to
        {{ Math.min(currentPage * pageSize, totalRecords) }}
        of {{ totalRecords }} entries
      </div>
      <nav>
        <ul class="pagination mb-0">
          <li class="page-item" [class.disabled]="currentPage === 1">
            <button class="page-link" (click)="goToPage(currentPage - 1)">
              Previous
            </button>
          </li>

          <li
            class="page-item"
            *ngFor="let page of [].constructor(totalPages); let i = index"
            [class.active]="currentPage === i + 1"
          >
            <button class="page-link" (click)="goToPage(i + 1)">
              {{ i + 1 }}
            </button>
          </li>

          <li
            class="page-item"
            [class.disabled]="currentPage === totalPages || totalPages === 0"
          >
            <button class="page-link" (click)="goToPage(currentPage + 1)">
              Next
            </button>
          </li>
        </ul>
      </nav>
    </div>
  </div>
</div>
